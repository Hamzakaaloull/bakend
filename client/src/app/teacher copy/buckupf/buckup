// // src/app/teacher/page.js
// "use client";
// import { useEffect, useState } from "react";
// import {
//   Box,
//   Typography,
//   List,
//   ListItem,
//   ListItemText,
//   ListItemIcon,
//   Divider,
//   Paper,
//   Table,
//   TableBody,
//   TableCell,
//   TableContainer,
//   TableHead,
//   TableRow,
//   Accordion,
//   AccordionSummary,
//   AccordionDetails,
//   Button,
//   Chip,
// } from "@mui/material";
// import {
//   Home as HomeIcon,
//   EventNote as EventNoteIcon,
//   ExpandMore,
//   Description,
// } from "@mui/icons-material";
// import { useRouter } from "next/navigation";

// export default function TeacherPage() {
//   const [menuOption, setMenuOption] = useState("home");
//   const [teacherInfo, setTeacherInfo] = useState(null);
//   const [activeSessions, setActiveSessions] = useState([]);
//   const [courses, setCourses] = useState([]);
//   const router = useRouter();

//   useEffect(() => {
//     const token = localStorage.getItem("token");
//     if (!token) router.push("/login");
//     else {
//       fetchTeacherData(token);
//       fetchActiveSessions(token);
//       fetchCourses(token);
//     }
//   }, []);

//   // ÿ¨ŸÑÿ® ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿπŸÑŸÖ
//   const fetchTeacherData = async (token) => {
//     try {
//       const response = await fetch(
//         "http://localhost:1337/api/users/me?populate=role",
//         {
//           headers: { Authorization: `Bearer ${token}` },
//         }
//       );
//       const data = await response.json();
//       setTeacherInfo(data);
//     } catch (error) {
//       console.error("Erreur lors de la r√©cup√©ration des donn√©es:", error);
//     }
//   };

//   // ÿ¨ŸÑÿ® ÿßŸÑÿ¨ŸÑÿ≥ÿßÿ™ ÿßŸÑŸÜÿ¥ÿ∑ÿ©
//   const fetchActiveSessions = async (token) => {
//     try {
//       const now = new Date();
//       const today = now.toISOString().split("T")[0];
//       const currentTime = now.toTimeString().split(" ")[0];

//       // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿßÿ≥ÿ™ÿπŸÑÿßŸÖ ŸÑÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿπŸÑÿßŸÇÿßÿ™
//       const response = await fetch(
//         `http://localhost:1337/api/seances?filters[date][$eq]=${today}&filters[start_time][$lte]=${currentTime}&filters[end_time][$gte]=${currentTime}&populate=cour,brigade`,
//         { headers: { Authorization: `Bearer ${token}` } }
//       );
//       const data = await response.json();
//       setActiveSessions(data.data || []);
//     } catch (error) {
//       console.error("Erreur lors de la r√©cup√©ration des sessions:", error);
//     }
//   };

//   // ÿ¨ŸÑÿ® ÿ¨ŸÖŸäÿπ ÿßŸÑŸÖŸàÿßÿØ
//   const fetchCourses = async (token) => {
//     try {
//       const response = await fetch("http://localhost:1337/api/courss", {
//         headers: { Authorization: `Bearer ${token}` },
//       });
//       const data = await response.json();
//       setCourses(data.data || []);
//     } catch (error) {
//       console.error("Erreur lors de la r√©cup√©ration des cours:", error);
//     }
//   };

//   // ÿØÿßŸÑÿ© ŸÑŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿßŸÑŸÖÿßÿØÿ© ÿßŸÑŸÖÿ±ÿ™ÿ®ÿ∑ÿ© ÿ®ÿßŸÑÿ¨ŸÑÿ≥ÿ©
//   const findCourseById = (courseId) => {
//     return courses.find((course) => course.id === courseId);
//   };

//   return (
//     <Box sx={{ display: "flex", minHeight: "100vh" }}>
//       {/* ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ¨ÿßŸÜÿ®Ÿäÿ© */}
//       <Box
//         sx={{
//           width: 280,
//           backgroundColor: "#2E3B55",
//           color: "white",
//           boxShadow: "2px 0 5px rgba(0,0,0,0.1)",
//           position: "fixed",
//           left: 0,
//           top: 0,
//           bottom: 0,
//         }}
//       >
//         <Typography
//           variant="h5"
//           sx={{
//             textAlign: "center",
//             mt: 3,
//             mb: 4,
//             fontWeight: "bold",
//             color: "#BBDEFB",
//           }}
//         >
//           Tableau de bord
//         </Typography>
//         <List>
//           <ListItem
//             button="true" // ÿ•ÿµŸÑÿßÿ≠ ÿ™ÿ≠ÿ∞Ÿäÿ± React
//             selected={menuOption === "home"}
//             onClick={() => setMenuOption("home")}
//             sx={{
//               "&.Mui-selected": { backgroundColor: "#42A5F5" },
//               borderRadius: "8px",
//               mx: 2,
//               mb: 1,
//             }}
//           >
//             <ListItemIcon sx={{ color: "white" }}>
//               <HomeIcon />
//             </ListItemIcon>
//             <ListItemText primary="Accueil" />
//           </ListItem>
//           <ListItem
//             button="true" // ÿ•ÿµŸÑÿßÿ≠ ÿ™ÿ≠ÿ∞Ÿäÿ± React
//             selected={menuOption === "seance"}
//             onClick={() => setMenuOption("seance")}
//             sx={{
//               "&.Mui-selected": { backgroundColor: "#42A5F5" },
//               borderRadius: "8px",
//               mx: 2,
//               mb: 1,
//             }}
//           >
//             <ListItemIcon sx={{ color: "white" }}>
//               <EventNoteIcon />
//             </ListItemIcon>
//             <ListItemText primary="S√©ances" />
//           </ListItem>
//         </List>
//       </Box>

//       {/* ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä */}
//       <Box
//         component="main"
//         sx={{
//           flexGrow: 1,
//           p: 4,
//           ml: "280px",
//           backgroundColor: "#F5F5F5",
//           minHeight: "100vh",
//         }}
//       >
//         {/* ÿµŸÅÿ≠ÿ© "ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©" */}
//         {menuOption === "home" && teacherInfo && (
//           <Paper
//             elevation={3}
//             sx={{
//               p: 4,
//               borderRadius: "16px",
//               backgroundColor: "#FFFFFF",
//               mb: 4,
//             }}
//           >
//             <Typography variant="h4" sx={{ mb: 3, color: "#2E3B55" }}>
//               Informations Personnelles
//             </Typography>
//             <Box sx={{ display: "flex", flexDirection: "column", gap: 2 }}>
//               <Typography>
//                 <strong>Nom d'utilisateur:</strong> {teacherInfo.username}
//               </Typography>
//               <Typography>
//                 <strong>Email:</strong> {teacherInfo.email}
//               </Typography>
//               <Typography>
//                 <strong>R√¥le:</strong>{" "}
//                 {teacherInfo.role?.name || "Non sp√©cifi√©"}
//               </Typography>
//               <Typography>
//                 <strong>Date de cr√©ation:</strong>{" "}
//                 {new Date(teacherInfo.createdAt).toLocaleDateString("fr-FR")}
//               </Typography>
//             </Box>
//           </Paper>
//         )}

//         {/* ÿµŸÅÿ≠ÿ© "ÿßŸÑÿ¨ŸÑÿ≥ÿßÿ™" */}
//         {menuOption === "seance" && (
//           <Box>
//             <Typography variant="h4" sx={{ mb: 4, color: "#2E3B55" }}>
//               S√©ances Actives
//             </Typography>
//             <TableContainer component={Paper} sx={{ mb: 4 }}>
//               <Table>
//                 <TableHead sx={{ backgroundColor: "#2E3B55" }}>
//                   <TableRow>
//                     <TableCell sx={{ color: "white" }}>Date</TableCell>
//                     <TableCell sx={{ color: "white" }}>
//                       Heure de d√©but
//                     </TableCell>
//                     <TableCell sx={{ color: "white" }}>Heure de fin</TableCell>
//                     <TableCell sx={{ color: "white" }}>Mati√®re</TableCell>
//                     <TableCell sx={{ color: "white" }}>Contenu</TableCell>
//                   </TableRow>
//                 </TableHead>
//                 <TableBody>
//                   {activeSessions.map((session) => {
//                     const course = findCourseById(session.attributes.cour?.id); // ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿßŸÑŸÖÿßÿØÿ©
//                     return (
//                       <TableRow key={session.id}>
//                         <TableCell>
//                           {new Date(session.attributes.date).toLocaleDateString(
//                             "fr-FR"
//                           )}
//                         </TableCell>
//                         <TableCell>
//                           {session.attributes.start_time || "Non sp√©cifi√©e"}
//                         </TableCell>
//                         <TableCell>
//                           {session.attributes.end_time || "Non sp√©cifi√©e"}
//                         </TableCell>
//                         <TableCell>
//                           <strong>
//                             {course?.attributes?.title || "Mati√®re non trouv√©e"}
//                           </strong>
//                         </TableCell>
//                         <TableCell>
//                           <Accordion
//                             sx={{ boxShadow: "none", bgcolor: "transparent" }}
//                           >
//                             <AccordionSummary expandIcon={<ExpandMore />}>
//                               <Button
//                                 variant="contained"
//                                 color="primary"
//                                 startIcon={<Description />}
//                                 size="small"
//                                 disabled={!course?.attributes?.cour_content}
//                               >
//                                 Voir le contenu
//                               </Button>
//                             </AccordionSummary>
//                             <AccordionDetails>
//                               {course?.attributes?.cour_content ? (
//                                 <Box sx={{ mt: 2 }}>
//                                   <Typography variant="subtitle1" gutterBottom>
//                                     Contenu du cours :
//                                   </Typography>
//                                   <Box
//                                     sx={{
//                                       display: "flex",
//                                       flexDirection: "column",
//                                       gap: 1,
//                                     }}
//                                   >
//                                     {course.attributes.cour_content
//                                       .split(",")
//                                       .map((file, index) => (
//                                         <Chip
//                                           key={index}
//                                           label={file.trim()}
//                                           icon={<Description />}
//                                           variant="outlined"
//                                           sx={{ maxWidth: "300px" }}
//                                         />
//                                       ))}
//                                   </Box>
//                                 </Box>
//                               ) : (
//                                 <Typography>
//                                   Aucun contenu disponible
//                                 </Typography>
//                               )}
//                             </AccordionDetails>
//                           </Accordion>
//                         </TableCell>
//                       </TableRow>
//                     );
//                   })}
//                 </TableBody>
//               </Table>
//             </TableContainer>
//           </Box>
//         )}
//       </Box>
//     </Box>
//   );
// }




// // the kast
// // src/app/teacher/page.js
// "use client";
// // src/app/teacher/page.js
// import { useEffect, useState } from "react";
// import {
//   Box,
//   Typography,
//   List,
//   ListItem,
//   ListItemText,
//   ListItemIcon,
//   Divider,
//   Paper,
//   Table,
//   TableBody,
//   TableCell,
//   TableContainer,
//   TableHead,
//   TableRow,
//   Button,
//   Alert,
// } from "@mui/material";
// import {
//   Home as HomeIcon,
//   EventNote as EventNoteIcon,
// } from "@mui/icons-material";
// import { useRouter } from "next/navigation";

// export default function TeacherPage() {
//   const [menuOption, setMenuOption] = useState("home");
//   const [teacherInfo, setTeacherInfo] = useState(null);
//   const [activeSession, setActiveSession] = useState(null);
//   const [showSuccess, setShowSuccess] = useState(false);
//   const router = useRouter();

//   useEffect(() => {
//     const token = localStorage.getItem("token");
//     if (!token) router.push("/login");
//     else {
//       fetchTeacherData(token);
//       checkAndUpdateActiveSession(token);
//     }
//   }, []);

//   // ÿ¨ŸÑÿ® ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿπŸÑŸÖ
//   const fetchTeacherData = async (token) => {
//     try {
//       const response = await fetch(
//         "http://localhost:1337/api/users/me?populate=role",
//         {
//           headers: { Authorization: `Bearer ${token}` },
//         }
//       );
//       const data = await response.json();
//       setTeacherInfo(data);
//     } catch (error) {
//       console.error("Erreur lors de la r√©cup√©ration des donn√©es:", error);
//     }
//   };

//   // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ¨ŸÑÿ≥ÿ© ÿßŸÑŸÜÿ¥ÿ∑ÿ© Ÿàÿ™ÿ≥ÿ¨ŸäŸÑ ŸàŸÇÿ™ ÿßŸÑÿ≠ÿ∂Ÿàÿ±
//   const checkAndUpdateActiveSession = async (token) => {
//     try {
//       const now = new Date();
//       const today = now.toISOString().split("T")[0];
//       const currentTime = now.toTimeString().split(" ")[0];

//       // ÿ¨ŸÑÿ® ÿ¨ŸÖŸäÿπ ÿßŸÑÿ¨ŸÑÿ≥ÿßÿ™ ÿßŸÑŸÖÿ¨ÿØŸàŸÑÿ© ŸÑŸÑŸÖÿπŸÑŸÖ
//       const response = await fetch(
//         `http://localhost:1337/api/seances?filters[date][$eq]=${today}&populate=cour`,
//         { headers: { Authorization: `Bearer ${token}` } }
//       );
//       const data = await response.json();
//       console.log(data);
//       // ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ÿßŸÑÿ¨ŸÑÿ≥ÿ© ÿßŸÑŸÜÿ¥ÿ∑ÿ©
//       const session = data.data.find((s) => {
//         const startTime = new Date(`${s.date}T${s.start_time}`);
//         const endTime = new Date(`${s.date}T${s.end_time}`);
//         return now >= startTime && now <= endTime;
//       });

//       if (session) {
//         setActiveSession(session);

//         // ÿ™ÿ≥ÿ¨ŸäŸÑ ŸàŸÇÿ™ ÿßŸÑÿ≠ÿ∂Ÿàÿ± ŸÅŸä ÿßŸÑÿ¨ŸÑÿ≥ÿ©
//         await fetch(`http://localhost:1337/api/seances/${session.id}`, {
//           method: "PUT",
//           headers: {
//             Authorization: `Bearer ${token}`,
//             "Content-Type": "application/json",
//           },
//           body: JSON.stringify({
//             data: {
//               time_presence: now.toISOString(),
//             },
//           }),
//         });

//         setShowSuccess(true); // ÿπÿ±ÿ∂ ÿ±ÿ≥ÿßŸÑÿ© ŸÜÿ¨ÿßÿ≠
//         console.log("Session ID:", session.id);
//       }
//     } catch (error) {
//       console.error(
//         "Erreur lors de la v√©rification de la session active:",
//         error
//       );
//     }
//   };

//   return (
//     <Box sx={{ display: "flex", minHeight: "100vh" }}>
//       {/* ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ¨ÿßŸÜÿ®Ÿäÿ© */}
//       <Box
//         sx={{
//           width: 280,
//           backgroundColor: "#2E3B55",
//           color: "white",
//           boxShadow: "2px 0 5px rgba(0,0,0,0.1)",
//           position: "fixed",
//           left: 0,
//           top: 0,
//           bottom: 0,
//         }}
//       >
//         <Typography
//           variant="h5"
//           sx={{
//             textAlign: "center",
//             mt: 3,
//             mb: 4,
//             fontWeight: "bold",
//             color: "#BBDEFB",
//           }}
//         >
//           Tableau de bord
//         </Typography>
//         <List>
//           <ListItem
//             button
//             selected={menuOption === "home"}
//             onClick={() => setMenuOption("home")}
//             sx={{
//               "&.Mui-selected": { backgroundColor: "#42A5F5" },
//               borderRadius: "8px",
//               mx: 2,
//               mb: 1,
//             }}
//           >
//             <ListItemIcon sx={{ color: "white" }}>
//               <HomeIcon />
//             </ListItemIcon>
//             <ListItemText primary="Accueil" />
//           </ListItem>
//           <ListItem
//             button
//             selected={menuOption === "seance"}
//             onClick={() => setMenuOption("seance")}
//             sx={{
//               "&.Mui-selected": { backgroundColor: "#42A5F5" },
//               borderRadius: "8px",
//               mx: 2,
//               mb: 1,
//             }}
//           >
//             <ListItemIcon sx={{ color: "white" }}>
//               <EventNoteIcon />
//             </ListItemIcon>
//             <ListItemText primary="S√©ances" />
//           </ListItem>
//         </List>
//       </Box>

//       {/* ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä */}
//       <Box
//         component="main"
//         sx={{
//           flexGrow: 1,
//           p: 4,
//           ml: "280px",
//           backgroundColor: "#F5F5F5",
//           minHeight: "100vh",
//         }}
//       >
//         {/* ÿµŸÅÿ≠ÿ© "ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©" */}
//         {menuOption === "home" && teacherInfo && (
//           <Paper
//             elevation={3}
//             sx={{
//               p: 4,
//               borderRadius: "16px",
//               backgroundColor: "#FFFFFF",
//               mb: 4,
//             }}
//           >
//             <Typography variant="h4" sx={{ mb: 3, color: "#2E3B55" }}>
//               Informations Personnelles
//             </Typography>
//             <Box sx={{ display: "flex", flexDirection: "column", gap: 2 }}>
//               <Typography>
//                 <strong>Nom d'utilisateur:</strong> {teacherInfo.username}
//               </Typography>
//               <Typography>
//                 <strong>Email:</strong> {teacherInfo.email}
//               </Typography>
//               <Typography>
//                 <strong>R√¥le:</strong>{" "}
//                 {teacherInfo.role?.name || "Non sp√©cifi√©"}
//               </Typography>
//             </Box>
//           </Paper>
//         )}

//         {/* ÿµŸÅÿ≠ÿ© "ÿßŸÑÿ¨ŸÑÿ≥ÿßÿ™" */}
//         {menuOption === "seance" && (
//           <Box>
//             <Typography variant="h4" sx={{ mb: 4, color: "#2E3B55" }}>
//               S√©ance Active
//             </Typography>
//             {showSuccess && (
//               <Alert severity="success" sx={{ mb: 4 }}>
//                 Votre pr√©sence a √©t√© enregistr√©e avec succ√®s!
//               </Alert>
//             )}
//             {activeSession ? (
//               <TableContainer component={Paper}>
//                 <Table>
//                   <TableHead sx={{ backgroundColor: "#2E3B55" }}>
//                     <TableRow>
//                       <TableCell sx={{ color: "white" }}>Date</TableCell>
//                       <TableCell sx={{ color: "white" }}>
//                         Heure de d√©but
//                       </TableCell>
//                       <TableCell sx={{ color: "white" }}>
//                         Heure de fin
//                       </TableCell>
//                       <TableCell sx={{ color: "white" }}>Mati√®re</TableCell>
//                       <TableCell sx={{ color: "white" }}>Pr√©sence</TableCell>
//                     </TableRow>
//                   </TableHead>
//                   <TableBody>
//                     <TableRow>
//                       <TableCell>
//                         {new Date(activeSession.date).toLocaleDateString(
//                           "fr-FR"
//                         )}
//                       </TableCell>
//                       <TableCell>{activeSession.start_time}</TableCell>
//                       <TableCell>{activeSession.end_time}</TableCell>
//                       <TableCell>
//                         {activeSession.cour?.title || "Mati√®re non trouv√©e"}
//                       </TableCell>
//                       <TableCell>
//                         {activeSession.time_presence
//                           ? new Date(
//                               activeSession.time_presence
//                             ).toLocaleString("fr-FR")
//                           : "Non enregistr√©e"}
//                       </TableCell>
//                     </TableRow>
//                   </TableBody>
//                 </Table>
//               </TableContainer>
//             ) : (
//               <Alert severity="info">Aucune s√©ance active trouv√©e.</Alert>
//             )}
//           </Box>
//         )}
//       </Box>
//     </Box>
//   );
// }





// last one 

// src/app/teacher/page.js
// src/app/teacher/page.js
// "use client";
// import { useEffect, useState } from "react";
// import {
//   Box,
//   Typography,
//   List,
//   ListItem,
//   ListItemText,
//   ListItemIcon,
//   Divider,
//   Paper,
//   Table,
//   TableBody,
//   TableCell,
//   TableContainer,
//   TableHead,
//   TableRow,
//   Button,
//   Alert,
// } from "@mui/material";
// import {
//   Home as HomeIcon,
//   EventNote as EventNoteIcon,
// } from "@mui/icons-material";
// import { useRouter } from "next/navigation";

// export default function TeacherPage() {
//   const [menuOption, setMenuOption] = useState("home");
//   const [teacherInfo, setTeacherInfo] = useState(null);
//   const [activeSession, setActiveSession] = useState(null);
//   const [showSuccess, setShowSuccess] = useState(false);
//   const router = useRouter();

//   useEffect(() => {
//     const token = localStorage.getItem("token");
//     if (!token) router.push("/login");
//     else {
//       fetchTeacherData(token);
//       checkAndUpdateActiveSession(token);
//     }
//   }, []);

//   // ÿ¨ŸÑÿ® ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿπŸÑŸÖ
//   const fetchTeacherData = async (token) => {
//     try {
//       const response = await fetch(
//         "http://localhost:1337/api/users/me?populate=role",
//         {
//           headers: { Authorization: `Bearer ${token}` },
//         }
//       );
//       const data = await response.json();
//       setTeacherInfo(data);
//     } catch (error) {
//       console.error("Erreur lors de la r√©cup√©ration des donn√©es:", error);
//     }
//   };

//   // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ¨ŸÑÿ≥ÿ© ÿßŸÑŸÜÿ¥ÿ∑ÿ© Ÿàÿ™ÿ≥ÿ¨ŸäŸÑ ŸàŸÇÿ™ ÿßŸÑÿ≠ÿ∂Ÿàÿ±
//   const checkAndUpdateActiveSession = async (token) => {
//     try {
//       const now = new Date();
//       const today = now.toISOString().split("T")[0];
//       const currentTime = now.toTimeString().split(" ")[0];

//       // ÿ¨ŸÑÿ® ÿ¨ŸÖŸäÿπ ÿßŸÑÿ¨ŸÑÿ≥ÿßÿ™ ÿßŸÑŸÖÿ¨ÿØŸàŸÑÿ© ŸÑŸÑŸÖÿπŸÑŸÖ
//       const response = await fetch(
//         `http://localhost:1337/api/seances?filters[date][$eq]=${today}&populate=cour`,
//         { headers: { Authorization: `Bearer ${token}` } }
//       );
//       const data = await response.json();
//       console.log(data);
//       // ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ÿßŸÑÿ¨ŸÑÿ≥ÿ© ÿßŸÑŸÜÿ¥ÿ∑ÿ©
//       const session = data.data.find((s) => {
//         const startTime = new Date(`${s.date}T${s.start_time}`);
//         const endTime = new Date(`${s.date}T${s.end_time}`);
//         return now >= startTime && now <= endTime;
//       });

//       if (session) {
//         setActiveSession(session);

//         // ÿ™ÿ≥ÿ¨ŸäŸÑ ŸàŸÇÿ™ ÿßŸÑÿ≠ÿ∂Ÿàÿ± ŸÅŸä ÿßŸÑÿ¨ŸÑÿ≥ÿ©
//         await fetch(`http://localhost:1337/api/seances/${session.id}`, {
//           method: "PUT",
//           headers: {
//             Authorization: `Bearer ${token}`,
//             "Content-Type": "application/json",
//           },
//           body: JSON.stringify({
//             data: {
//               time_presence: now.toISOString(),
//             },
//           }),
//         });

//         setShowSuccess(true); // ÿπÿ±ÿ∂ ÿ±ÿ≥ÿßŸÑÿ© ŸÜÿ¨ÿßÿ≠
//         console.log("Session ID:", session.id);
//       }
//     } catch (error) {
//       console.error(
//         "Erreur lors de la v√©rification de la session active:",
//         error
//       );
//     }
//   };

//   return (
//     <Box sx={{ display: "flex", minHeight: "100vh" }}>
//       {/* ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ¨ÿßŸÜÿ®Ÿäÿ© */}
//       <Box
//         sx={{
//           width: 280,
//           backgroundColor: "#2E3B55",
//           color: "white",
//           boxShadow: "2px 0 5px rgba(0,0,0,0.1)",
//           position: "fixed",
//           left: 0,
//           top: 0,
//           bottom: 0,
//         }}
//       >
//         <Typography
//           variant="h5"
//           sx={{
//             textAlign: "center",
//             mt: 3,
//             mb: 4,
//             fontWeight: "bold",
//             color: "#BBDEFB",
//           }}
//         >
//           Tableau de bord
//         </Typography>
//         <List>
//           <ListItem
//             button
//             selected={menuOption === "home"}
//             onClick={() => setMenuOption("home")}
//             sx={{
//               "&.Mui-selected": { backgroundColor: "#42A5F5" },
//               borderRadius: "8px",
//               mx: 2,
//               mb: 1,
//             }}
//           >
//             <ListItemIcon sx={{ color: "white" }}>
//               <HomeIcon />
//             </ListItemIcon>
//             <ListItemText primary="Accueil" />
//           </ListItem>
//           <ListItem
//             button
//             selected={menuOption === "seance"}
//             onClick={() => setMenuOption("seance")}
//             sx={{
//               "&.Mui-selected": { backgroundColor: "#42A5F5" },
//               borderRadius: "8px",
//               mx: 2,
//               mb: 1,
//             }}
//           >
//             <ListItemIcon sx={{ color: "white" }}>
//               <EventNoteIcon />
//             </ListItemIcon>
//             <ListItemText primary="S√©ances" />
//           </ListItem>
//         </List>
//       </Box>

//       {/* ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä */}
//       <Box
//         component="main"
//         sx={{
//           flexGrow: 1,
//           p: 4,
//           ml: "280px",
//           backgroundColor: "#F5F5F5",
//           minHeight: "100vh",
//         }}
//       >
//         {/* ÿµŸÅÿ≠ÿ© "ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©" */}
//         {menuOption === "home" && teacherInfo && (
//           <Paper
//             elevation={3}
//             sx={{
//               p: 4,
//               borderRadius: "16px",
//               backgroundColor: "#FFFFFF",
//               mb: 4,
//             }}
//           >
//             <Typography variant="h4" sx={{ mb: 3, color: "#2E3B55" }}>
//               Informations Personnelles
//             </Typography>
//             <Box sx={{ display: "flex", flexDirection: "column", gap: 2 }}>
//               <Typography>
//                 <strong>Nom d'utilisateur:</strong> {teacherInfo.username}
//               </Typography>
//               <Typography>
//                 <strong>Email:</strong> {teacherInfo.email}
//               </Typography>
//               <Typography>
//                 <strong>R√¥le:</strong>{" "}
//                 {teacherInfo.role?.name || "Non sp√©cifi√©"}
//               </Typography>
//             </Box>
//           </Paper>
//         )}

//         {/* ÿµŸÅÿ≠ÿ© "ÿßŸÑÿ¨ŸÑÿ≥ÿßÿ™" */}
//         {menuOption === "seance" && (
//           <Box>
//             <Typography variant="h4" sx={{ mb: 4, color: "#2E3B55" }}>
//               S√©ance Active
//             </Typography>
//             {showSuccess && (
//               <Alert severity="success" sx={{ mb: 4 }}>
//                 Votre pr√©sence a √©t√© enregistr√©e avec succ√®s!
//               </Alert>
//             )}
//             {activeSession ? (
//               <TableContainer component={Paper}>
//                 <Table>
//                   <TableHead sx={{ backgroundColor: "#2E3B55" }}>
//                     <TableRow>
//                       <TableCell sx={{ color: "white" }}>Date</TableCell>
//                       <TableCell sx={{ color: "white" }}>
//                         Heure de d√©but
//                       </TableCell>
//                       <TableCell sx={{ color: "white" }}>
//                         Heure de fin
//                       </TableCell>
//                       <TableCell sx={{ color: "white" }}>Mati√®re</TableCell>
//                       <TableCell sx={{ color: "white" }}>Pr√©sence</TableCell>
//                     </TableRow>
//                   </TableHead>
//                   <TableBody>
//                     <TableRow>
//                       <TableCell>
//                         {new Date(activeSession.date).toLocaleDateString(
//                           "fr-FR"
//                         )}
//                       </TableCell>
//                       <TableCell>{activeSession.start_time}</TableCell>
//                       <TableCell>{activeSession.end_time}</TableCell>
//                       <TableCell>
//                         {activeSession.cour?.title || "Mati√®re non trouv√©e"}
//                       </TableCell>
//                       <TableCell>
//                         {activeSession.time_presence
//                           ? new Date(
//                               activeSession.time_presence
//                             ).toLocaleString("fr-FR")
//                           : "Non enregistr√©e"}
//                       </TableCell>
//                     </TableRow>
//                   </TableBody>
//                 </Table>
//               </TableContainer>
//             ) : (
//               <Alert severity="info">Aucune s√©ance active trouv√©e.</Alert>
//             )}
//           </Box>
//         )}
//       </Box>
//     </Box>
//   );
// }





// last one 2

// src/app/teacher/page.js
// "use client";
// import { useEffect, useState } from "react";
// import {
//   Box,
//   Typography,
//   List,
//   ListItem,
//   ListItemText,
//   ListItemIcon,
//   Divider,
//   Paper,
//   Table,
//   TableBody,
//   TableCell,
//   TableContainer,
//   TableHead,
//   TableRow,
//   Button,
//   Alert,
// } from "@mui/material";
// import {
//   Home as HomeIcon,
//   EventNote as EventNoteIcon,
// } from "@mui/icons-material";
// import { useRouter } from "next/navigation";
// import Link from "next/link";

// export default function TeacherPage() {
//   const [menuOption, setMenuOption] = useState("home");
//   const [teacherInfo, setTeacherInfo] = useState(null);
//   const [activeSession, setActiveSession] = useState(null);
//   const [showSuccess, setShowSuccess] = useState(false);
//   const router = useRouter();

//   useEffect(() => {
//     const token = localStorage.getItem("token");
//     if (!token) router.push("/login");
//     else {
//       fetchTeacherData(token);
//       checkAndUpdateActiveSession(token);
//     }
//   }, []);

//   // ÿ¨ŸÑÿ® ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿπŸÑŸÖ ŸÖÿπ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÑ
//   const fetchTeacherData = async (token) => {
//     try {
//       const response = await fetch(
//         "http://localhost:1337/api/users/me?populate=role", // ÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿØŸàÿ±
//         {
//           headers: { Authorization: `Bearer ${token}` },
//         }
//       );
//       const data = await response.json();
//       setTeacherInfo(data);
//     } catch (error) {
//       console.error("Erreur lors de la r√©cup√©ration des donn√©es:", error);
//     }
//   };

//   // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ¨ŸÑÿ≥ÿ© ÿßŸÑŸÜÿ¥ÿ∑ÿ© Ÿàÿ™ÿ≥ÿ¨ŸäŸÑ ŸàŸÇÿ™ ÿßŸÑÿ≠ÿ∂Ÿàÿ±
//   const checkAndUpdateActiveSession = async (token) => {
//     try {
//       const now = new Date();
//       const today = now.toISOString().split("T")[0];
//       const currentTime = now.toTimeString().split(" ")[0];

//       // ÿ™ÿ≠ÿØŸäÿ´ ŸÖÿπŸÑŸÖÿ© populate ŸÑÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿπŸÑÿßŸÇÿ© ŸÖÿπ cour ÿ®ÿ¥ŸÉŸÑ ÿµÿ≠Ÿäÿ≠
//       const response = await fetch(
//         `http://localhost:1337/api/seances?filters[date][$eq]=${today}&populate[cour][populate][0]=cour_contant`, // ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ populate=cour
//         { headers: { Authorization: `Bearer ${token}` } }
//       );
//       const data = await response.json();
//       console.log("Donn√©es des sessions:", data);

//       if (data.error) {
//         console.error("Erreur Strapi:", data.error);
//         return;
//       }

//       // ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ÿßŸÑÿ¨ŸÑÿ≥ÿ© ÿßŸÑŸÜÿ¥ÿ∑ÿ©
//       const session = data.data.find((s) => {
//         const startTime = new Date(`${s.date}T${s.start_time}`);
//         const endTime = new Date(`${s.date}T${s.end_time}`);
//         return now >= startTime && now <= endTime;
//       });

//       if (session) {
//         setActiveSession(session);

//         // ÿ™ŸÜÿ≥ŸäŸÇ ÿßŸÑŸàŸÇÿ™ ŸÑŸÄ time_presence (HH:mm)
//         const formattedTime = now.toLocaleTimeString("fr-FR", {
//           hour: "2-digit",
//           minute: "2-digit",
//         });

//         // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ¨ŸÑÿ≥ÿ© ŸÖÿπ ÿ™ÿ≥ÿ¨ŸäŸÑ ŸàŸÇÿ™ ÿßŸÑÿ≠ÿ∂Ÿàÿ±
//         const updateResponse = await fetch(
//           `http://localhost:1337/api/seances/${session.id}`,
//           {
//             method: "PUT",
//             headers: {
//               Authorization: `Bearer ${token}`,
//               "Content-Type": "application/json",
//             },
//             body: JSON.stringify({
//               data: {
//                 time_presence: formattedTime,
//               },
//             }),
//           }
//         );

//         if (updateResponse.ok) {
//           setShowSuccess(true);
//           console.log("Pr√©sence enregistr√©e avec succ√®s!");
//         } else {
//           console.error(
//             "Erreur lors de la mise √† jour:",
//             updateResponse.statusText
//           );
//         }
//       }
//     } catch (error) {
//       console.error("Erreur globale:", error);
//     }
//   };

//   return (
//     <Box sx={{ display: "flex", minHeight: "100vh" }}>
//       {/* ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ¨ÿßŸÜÿ®Ÿäÿ© */}
//       <Box
//         sx={{
//           width: 280,
//           backgroundColor: "#2E3B55",
//           color: "white",
//           boxShadow: "2px 0 5px rgba(0,0,0,0.1)",
//           position: "fixed",
//           left: 0,
//           top: 0,
//           bottom: 0,
//         }}
//       >
//         <Typography
//           variant="h5"
//           sx={{
//             textAlign: "center",
//             mt: 3,
//             mb: 4,
//             fontWeight: "bold",
//             color: "#BBDEFB",
//           }}
//         >
//           Tableau de bord
//         </Typography>
//         <List>
//           <ListItem
//             button={`true`}
//             selected={menuOption === "home"}
//             onClick={() => setMenuOption("home")}
//             sx={{
//               "&.Mui-selected": { backgroundColor: "#42A5F5" },
//               borderRadius: "8px",
//               mx: 2,
//               mb: 1,
//             }}
//           >
//             <ListItemIcon sx={{ color: "white" }}>
//               <HomeIcon />
//             </ListItemIcon>
//             <ListItemText primary="Accueil" />
//           </ListItem>
//           <ListItem
//             button={`true`}
//             selected={menuOption === "seance"}
//             onClick={() => setMenuOption("seance")}
//             sx={{
//               "&.Mui-selected": { backgroundColor: "#42A5F5" },
//               borderRadius: "8px",
//               mx: 2,
//               mb: 1,
//             }}
//           >
//             <ListItemIcon sx={{ color: "white" }}>
//               <EventNoteIcon />
//             </ListItemIcon>
//             <ListItemText primary="S√©ances" />
//           </ListItem>
//         </List>
//       </Box>

//       {/* ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä */}
//       <Box
//         component="main"
//         sx={{
//           flexGrow: 1,
//           p: 4,
//           ml: "280px",
//           backgroundColor: "#F5F5F5",
//           minHeight: "100vh",
//         }}
//       >
//         {/* ÿµŸÅÿ≠ÿ© "ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©" */}
//         {menuOption === "home" && teacherInfo && (
//           <Paper
//             elevation={3}
//             sx={{
//               p: 4,
//               borderRadius: "16px",
//               backgroundColor: "#FFFFFF",
//               mb: 4,
//             }}
//           >
//             <Typography variant="h4" sx={{ mb: 3, color: "#2E3B55" }}>
//               Informations Personnelles
//             </Typography>
//             <Box sx={{ display: "flex", flexDirection: "column", gap: 2 }}>
//               <Typography>
//                 <strong>Nom d'utilisateur:</strong> {teacherInfo.username}
//               </Typography>
//               <Typography>
//                 <strong>Email:</strong> {teacherInfo.email}
//               </Typography>
//               <Typography>
//                 <strong>R√¥le:</strong>{" "}
//                 {teacherInfo.role?.name || "Non sp√©cifi√©"}
//               </Typography>
//               <Typography>
//                 <strong>Date de cr√©ation:</strong>{" "}
//                 {new Date(teacherInfo.createdAt).toLocaleDateString("fr-FR")}
//               </Typography>
//               <Typography>
//                 <strong>Derni√®re mise √† jour:</strong>{" "}
//                 {new Date(teacherInfo.updatedAt).toLocaleDateString("fr-FR")}
//               </Typography>
//             </Box>
//           </Paper>
//         )}

//         {/* ÿµŸÅÿ≠ÿ© "ÿßŸÑÿ¨ŸÑÿ≥ÿßÿ™" */}
//         {menuOption === "seance" && (
//           <Box>
//             <Typography variant="h4" sx={{ mb: 4, color: "#2E3B55" }}>
//               S√©ance Active
//             </Typography>
//             {showSuccess && (
//               <Alert severity="success" sx={{ mb: 4 }}>
//                 Votre pr√©sence a √©t√© enregistr√©e avec succ√®s!
//               </Alert>
//             )}
//             {activeSession ? (
//               <TableContainer component={Paper}>
//                 <Table>
//                   <TableHead sx={{ backgroundColor: "#2E3B55" }}>
//                     <TableRow>
//                       <TableCell sx={{ color: "white" }}>Date</TableCell>
//                       <TableCell sx={{ color: "white" }}>
//                         Heure de d√©but
//                       </TableCell>
//                       <TableCell sx={{ color: "white" }}>
//                         Heure de fin
//                       </TableCell>
//                       <TableCell sx={{ color: "white" }}>Mati√®re</TableCell>
//                       <TableCell sx={{ color: "white" }}>
//                         Document de mati√®re
//                       </TableCell>
//                       <TableCell sx={{ color: "white" }}>Pr√©sence</TableCell>
//                     </TableRow>
//                   </TableHead>
//                   <TableBody>
//                     <TableRow>
//                       <TableCell>
//                         {new Date(activeSession.date).toLocaleDateString(
//                           "fr-FR"
//                         )}
//                       </TableCell>
//                       <TableCell>{activeSession.start_time}</TableCell>
//                       <TableCell>{activeSession.end_time}</TableCell>
//                       <TableCell>
//                         {activeSession.cour?.title || "Mati√®re non trouv√©e"}
//                       </TableCell>
//                       <TableCell>
//                         <Link
//                           href={`http://localhost:1337/api{/uploads/553_1_ca9dbfdcfa.pdf}`}
//                           rel={activeSession.cour?.title}
//                           passHref
//                         >
//                           üìÑ T√©l√©charger : {activeSession.cour?.title}
//                         </Link>
//                       </TableCell>
//                       <TableCell>
//                         {activeSession.time_presence
//                           ? activeSession.time_presence
//                           : "Non enregistr√©e"}
//                       </TableCell>
//                     </TableRow>
//                   </TableBody>
//                 </Table>
//               </TableContainer>
//             ) : (
//               <Alert severity="info">Aucune s√©ance active trouv√©e.</Alert>
//             )}
//           </Box>
//         )}
//       </Box>
//     </Box>
//   );
// }
